@model TaskManagementSystem.Models.DashboardViewModel

@{
    ViewData["Title"] = "Dashboard";
    var total = Model.TotalTasks;
    var completedPct = total == 0 ? 0 : (int)Math.Round((double)Model.CompletedTasks * 100 / total);
    var pendingPct = total == 0 ? 0 : (int)Math.Round((double)Model.PendingTasks * 100 / total);
    var overduePct = total == 0 ? 0 : (int)Math.Round((double)Model.OverdueTasks * 100 / total);
}

<section class="dashboard-grid d-grid gap-3 mb-4">
    <article class="metric-card border rounded-3 p-3">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="metric-icon metric-blue">■</span>
            <span class="badge text-bg-secondary-subtle text-secondary-emphasis">100%</span>
        </div>
        <small class="text-body-secondary d-block">Total Tasks</small>
        <h2 class="mb-0">@Model.TotalTasks</h2>
    </article>

    <article class="metric-card border rounded-3 p-3">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="metric-icon metric-green">✓</span>
            <span class="badge text-bg-success-subtle text-success-emphasis">@completedPct%</span>
        </div>
        <small class="text-body-secondary d-block">Completed</small>
        <h2 class="mb-0">@Model.CompletedTasks</h2>
    </article>

    <article class="metric-card border rounded-3 p-3">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="metric-icon metric-amber">◔</span>
            <span class="badge text-bg-warning-subtle text-warning-emphasis">@pendingPct%</span>
        </div>
        <small class="text-body-secondary d-block">Pending</small>
        <h2 class="mb-0">@Model.PendingTasks</h2>
    </article>

    <article class="metric-card border rounded-3 p-3">
        <div class="d-flex justify-content-between align-items-start mb-2">
            <span class="metric-icon metric-red">⚠</span>
            <span class="badge text-bg-danger-subtle text-danger-emphasis">@overduePct%</span>
        </div>
        <small class="text-body-secondary d-block">Overdue</small>
        <h2 class="mb-0">@Model.OverdueTasks</h2>
    </article>
</section>

<section class="recent-section premium-surface border rounded-3 bg-body">
    <div class="recent-header px-3 py-3 border-bottom">
        <h5 class="mb-0">Recent Tasks</h5>
        <a asp-controller="Tasks" asp-action="Index" class="text-decoration-none"><i class="bi bi-list-task me-1"></i>View All →</a>
    </div>

    <div class="table-responsive">
        <table class="table premium-table recent-tasks-table mb-0 align-middle">
            <thead>
                <tr>
                    <th class="text-uppercase small text-body-secondary">Task Name</th>
                    <th class="text-uppercase small text-body-secondary">Due Date</th>
                    <th class="text-uppercase small text-body-secondary">Status</th>
                    <th class="text-uppercase small text-body-secondary">Priority</th>
                    <th class="text-uppercase small text-body-secondary text-end">Actions</th>
                </tr>
            </thead>
            <tbody>
                @if (!Model.RecentTasks.Any())
                {
                    <tr>
                        <td colspan="5" class="text-center text-body-secondary py-4">No tasks available yet.</td>
                    </tr>
                }
                else
                {
                    @foreach (var task in Model.RecentTasks)
                    {
                        <tr>
                            <td class="task-column">
                                <div class="fw-semibold task-title">@task.Title</div>
                                <small class="text-body-secondary task-description" title="@task.Description">@task.Description</small>
                            </td>
                            <td>@task.DueDate.ToString("MMM dd, yyyy")</td>
                            <td>
                                @if (task.Status.Equals("Completed", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="badge text-bg-success-subtle text-success-emphasis">Completed</span>
                                }
                                else
                                {
                                    <span class="badge text-bg-secondary-subtle text-secondary-emphasis">Pending</span>
                                }
                            </td>
                            <td>
                                @if (task.Priority.Equals("High", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="badge text-bg-danger-subtle text-danger-emphasis">High</span>
                                }
                                else if (task.Priority.Equals("Medium", StringComparison.OrdinalIgnoreCase))
                                {
                                    <span class="badge text-bg-warning-subtle text-warning-emphasis">Medium</span>
                                }
                                else
                                {
                                    <span class="badge text-bg-success-subtle text-success-emphasis">Low</span>
                                }
                            </td>
                            <td class="text-end action-column">
                                <a asp-controller="Tasks" asp-action="Details" asp-route-id="@task.Id" class="btn btn-sm btn-outline-primary view-details-btn"><i class="bi bi-eye me-1"></i>View Details →</a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</section>

<section class="visually-hidden">
    Content placeholder
</section>
